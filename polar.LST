C51 COMPILER V9.00   POLAR                                                                 03/18/2016 16:14:08 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE POLAR
OBJECT MODULE PLACED IN polar.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE polar.c LARGE OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /***********************************************************************
   2          * 
   3          * 时    间：2008-10-9
   4          *
   5          * 文 件 名：polar.c
   6          *
   7          * 版    本：AKD10P07(发布版)
   8          *
   9          * 作    者：北京爱科迪信息通讯技术有限公司―技术部―杨淳雯
  10          * 
  11          * 功能说明：极化转动函数
  12          *
  13          ***********************************************************************/
  14          #include "c8051f120.h"
  15          #include "station.h"
  16          #include "adc.h"
  17          #include "timer.h"
  18          #include "antenna.h"
  19          #include "polar.h"
  20          #include "rweeprom.h"
  21          
  22          
  23          UINT16 xdata PolarFlag = 0;             //极化是否可转动标志
  24          UINT16 xdata PloarNormal = 0;   //极化正常标志
  25          UINT8 xdata PloarAngleStage = 0;         //极化角所处台阶
  26          
  27          /***********************************************************************
  28          *
  29          * 函数原型：void GotoPolarAngle(float angle)
  30          *
  31          * 入口参数：目标角度
  32          *
  33          * 出口参数：无
  34          *
  35          * 功能描述：转到目标极化角度
  36          *
  37          * 注    意：PolarDst全局变量!!!
  38          *
  39          ***********************************************************************/
  40          void GotoPolarAngle(float angle)
  41          {
  42   1              if((PolarFlag == 0) && \
  43   1                      ((ReadEEPROM(PolCompensateAddress) == '+') || \
  44   1                      (ReadEEPROM(PolCompensateAddress) == '-')))
  45   1              {
  46   2                      PolarFlag = 2;
  47   2                      if(ReadEEPROM(PolCompensateAddress) == '+')
  48   2                      {
  49   3                              AngleCom = ReadEEPROM(PolCompensateAddress + 1);
  50   3                      }
  51   2                      if(ReadEEPROM(PolCompensateAddress) == '-')
  52   2                      {
  53   3                              AngleCom = 0.0 - ReadEEPROM(PolCompensateAddress + 1);
  54   3                      }
  55   2              }
C51 COMPILER V9.00   POLAR                                                                 03/18/2016 16:14:08 PAGE 2   

  56   1      
  57   1              PolarFlag = 2;                                                                   //2012
  58   1      
  59   1              if(PolarFlag == 2)
  60   1              {
  61   2                      PolarRightFlag = 0;                             //极化角未到位
  62   2      //*----------------------------------------------------------------
  63   2      //              if(angle < -90.0)                                       //保护
  64   2      //              {
  65   2      //                      angle = -90.0;
  66   2      //              }
  67   2      //              if(angle > 90.0)
  68   2      //              {
  69   2      //                      angle = 90.0;
  70   2      //              }
  71   2      //---------------------------------------------------------------*/
  72   2                      PolarDst = angle;
  73   2      //---------------------------------------------------------------*/
  74   2      
  75   2                      OpenTimer0Interrupt();
  76   2                      OpenTimer2Interrupt();
  77   2                      while(PolarRightFlag == 0 && OverflowT0 < 5000)
  78   2                      {
  79   3                              ;
  80   3                      }
  81   2                      POLAR_STOP;
  82   2                      CloseTimer2Interrupt();
  83   2                      CloseTimer0Interrupt();
  84   2                      if(OverflowT0 > 4999)
  85   2                      {
  86   3                              PloarNormal = 0;
  87   3                      }
  88   2                      else
  89   2                      {
  90   3                              PloarNormal = 1;
  91   3                      }
  92   2              }
  93   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    222    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      9    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
